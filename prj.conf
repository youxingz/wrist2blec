# 先把所有日志/控制台关掉（很多卡死发生在串口/console init）
CONFIG_LOG=y
CONFIG_CONSOLE=n
CONFIG_UART_CONSOLE=n
CONFIG_PRINTK=y
CONFIG_SERIAL=n
CONFIG_USE_SEGGER_RTT=y
CONFIG_SHELL_BACKEND_RTT=y

# 先关 flash/存储/文件系统（如果你工程里带了）
CONFIG_FLASH=y
CONFIG_FLASH_MAP=y
CONFIG_FLASH_PAGE_LAYOUT=y
CONFIG_SOC_FLASH_NRF=y
CONFIG_NVS=y
CONFIG_SETTINGS=n
CONFIG_FCB=n
CONFIG_FILE_SYSTEM=n

# 先别让任何低频时钟/外设复杂初始化影响（RC 32k，稳定）
CONFIG_CLOCK_CONTROL=y
CONFIG_CLOCK_CONTROL_NRF=y
CONFIG_CLOCK_CONTROL_NRF_K32SRC_RC=y
CONFIG_CLOCK_CONTROL_NRF_K32SRC_XTAL=n
CONFIG_CLOCK_CONTROL_NRF_K32SRC_SYNTH=n

###########################################################

################################
# Bluetooth Core
################################
CONFIG_BT=y
CONFIG_BT_PERIPHERAL=y
CONFIG_BT_DEVICE_NAME="BTrainer"

################################
# GATT / 需要 MTU 交换
################################
CONFIG_BT_GATT_CLIENT=y

################################
# PHY / DLE
################################
CONFIG_BT_CTLR_PHY_2M=y
CONFIG_BT_USER_PHY_UPDATE=y

CONFIG_BT_USER_DATA_LEN_UPDATE=y
CONFIG_BT_CTLR_DATA_LENGTH_MAX=251

################################
# MTU = 500（关键）
################################
CONFIG_BT_L2CAP_TX_MTU=500


# ATT MTU 交换：两边都至少 503（ATT=MTU，L2CAP/SDU 还要开销）
# Zephyr 的 ATT MTU 由 L2CAP_TX_MTU 驱动，但 buffer 也必须够
CONFIG_BT_BUF_ACL_TX_SIZE=500
CONFIG_BT_BUF_ACL_RX_SIZE=500

# 为了稳定，建议把 TX buffer 数量略抬高（默认有时不够导致 -ENOMEM）
CONFIG_BT_BUF_ACL_TX_COUNT=10
CONFIG_BT_BUF_EVT_RX_COUNT=12

################################
# Services
################################
CONFIG_BT_BAS=y
CONFIG_BT_DIS=y


################################
# DIS 信息（不走 settings）
################################
CONFIG_BT_DIS_PNP=n
CONFIG_BT_DIS_MODEL="EigenNeuroDev"
CONFIG_BT_DIS_MANUF="EigenNeuro"

CONFIG_BT_DIS_SERIAL_NUMBER=y
CONFIG_BT_DIS_SERIAL_NUMBER_STR="F.A000001"

CONFIG_BT_DIS_FW_REV=y
CONFIG_BT_DIS_FW_REV_STR="EigenNeuro Firmware"
CONFIG_BT_DIS_HW_REV=y
CONFIG_BT_DIS_HW_REV_STR="EigenNeuro Hardware"
CONFIG_BT_DIS_SW_REV=y
CONFIG_BT_DIS_SW_REV_STR="EigenNeuro Software"

CONFIG_BT_DIS_STR_MAX=32

################################
# ❌ 明确关闭 settings（否则必炸）
################################
CONFIG_BT_SETTINGS=n
CONFIG_SETTINGS=n
CONFIG_BT_DIS_SETTINGS=n


################################
# CONFIG
################################

CONFIG_GPIO=y
CONFIG_SPI=y
CONFIG_NRFX_SPIM=y

CONFIG_NRFX_TIMER=y

# CONFIG_NRFX_GPIOTE=y
CONFIG_PINCTRL=y
# CONFIG_I2C=y
CONFIG_ADC=y
CONFIG_NRFX_SAADC=y
